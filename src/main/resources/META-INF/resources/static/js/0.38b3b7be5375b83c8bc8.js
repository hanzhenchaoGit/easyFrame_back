webpackJsonp([0],{PwVi:function(n,t,e){var l=e("T/11");"string"==typeof l&&(l=[[n.i,l,""]]),l.locals&&(n.exports=l.locals);e("rjj0")("96dd9d3e",l,!0)},"T/11":function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},p3JC:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=e("woOf"),s=e.n(l),o={name:"ConsultManager",watch:{editConsult:function(n,t){this.fillEditConsultData(n)},operate:function(n,t){this.changeFormDisabled(n)}},props:{editConsult:{type:Object,default:function(){return{}}},operate:{type:String,default:"edit"}},mounted:function(){this.$set(this.entity.consult,"kfrymc",this.$store.getters.name),this.$set(this.entity.consult,"kfry",this.$store.getters.user),this.getXsTree(),this.fillEditConsultData(this.editConsult),this.changeFormDisabled(this.operate)},data:function(){return{disabledForm:!1,loading:{saveConsultLoading:!1,getConsultLoading:!1,checkRepeatLoading:!1},state:{commitDone:!1},rules:{zxly:[{required:!0,message:"请选择咨询来源",trigger:"blur"}],zxlylx:[{required:!0,message:"请选择咨询类型",trigger:"blur"}],khlx:[{required:!0,message:"请选择客户类型",trigger:"blur"}],sj:[{required:!0,message:"请填入手机",trigger:"blur"}],zj:[{required:!0,message:"请填入座机",trigger:"blur"}],sf:[{required:!0,message:"请选择省份",trigger:"blur"}],jcxm:[{required:!0,message:"请填入咨询内容",trigger:"blur"}],fpks:[{required:!0,message:"请选择分配科室",trigger:"blur"}],cfpd:[{required:!0,message:"请确认是否重复判定",trigger:"blur"}],qymcxl:[{required:!0,message:"请选择是否留企业名称",trigger:"blur"}],qymc:[{required:!0,message:"请录入企业名称",trigger:"blur"}]},file:{fileremark:"",groupid:"",list:[]},window:{uploadWindow:!1,selectXsWindow:!1},entity:{consult:{}},other:{repeatConsults:[]},tree:{xsTree:[]},table:{consult:{url:"/consult/checkRepeatConsult",columns:[{prop:"id",label:"id"},{prop:"zxbh",label:"咨询编号"},{prop:"createtime",label:"咨询时间",width:140},{prop:"zxlyname",label:"咨询来源"},{prop:"zxlylxname",label:"咨询类型"},{prop:"qymc",label:"企业名称"},{prop:"jcxm",label:"咨询内容"},{prop:"kfrymc",label:"客服人员"},{prop:"fpksmc",label:"分配科室",width:200},{prop:"xsrymc",label:"销售人员"},{prop:"status",label:"咨询状态"}]}},select:{zxly:{url:"system/proxyExcute?uuid=5a20cceb-ce98-4377-b6c1-958c1a1c0ff3&type=sources"},zxlylx:{url:"system/proxyExcute?uuid=5a20cceb-ce98-4377-b6c1-958c1a1c0ff3&type=sourcesType"},khlx:{url:"system/proxyExcute?uuid=5a20cceb-ce98-4377-b6c1-958c1a1c0ff3&type=khlx"},qymcxl:{url:"system/proxyExcute?uuid=5a20cceb-ce98-4377-b6c1-958c1a1c0ff3&type=qymc"},sf:{url:"system/proxyExcute?uuid=1faf1d01-88ed-4e8e-8975-7eaa2c179135&level=1"},cs:{url:"system/proxyExcute?uuid=1faf1d01-88ed-4e8e-8975-7eaa2c179135&level=2"},cfpd:{url:"system/proxyExcute?uuid=5a20cceb-ce98-4377-b6c1-958c1a1c0ff3&type=isnot"},fpks:{url:"system/proxyExcute?uuid=343d1975-5604-4041-9c07-4431b6742658"}}}},methods:{changeFormDisabled:function(n){"watch"===n?this.$set(this,"disabledForm",!0):this.$set(this,"disabledForm",!1)},fillEditConsultData:function(n){n.id&&("1"===n.assigntype?n.assigntype=!0:n.assigntype=!1,this.$set(this.entity,"consult",n),this.getFileList(n.fj))},getCs:function(n,t){this.$set(this.entity.consult,"cs",""),this.$refs.cs.loadData("pid="+t)},checkCs:function(){this.entity.consult.sf||(this.$set(this.entity.consult,"cs",""),this.$message({type:"warning",message:"请先选择省份"}))},saveConsult:function(n){var t=this;this.$refs.consult.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.loading.saveConsultLoading=!0,console.log(t.$refs.fpks),t.entity.consult.fpksmc=t.$refs.fpks.selectData.name;var l=s()({},t.entity.consult);t.entity.consult.fj=t.file.groupid,t.entity.consult.assigntype?l.assigntype="1":l.assigntype="2","save"===n?t.$request({url:"consult/addXmxxZxxx",method:"post",data:l}).then(function(n){t.returnMsg(t,n),t.$set(t.entity.consult,"zxbh",n.data.zxbh),t.entity.consult.id=n.data.id,t.loading.saveConsultLoading=!1}):t.$request({url:"consult/commitXmxxZxxx",method:"post",params:{ids:t.entity.consult.id}}).then(function(n){t.returnMsg(t,n),t.$set(t.state,"commitDone",!0),t.loading.saveConsultLoading=!1})})},getZxbh:function(n,t,e){console.log(n,t,e,11)},checkRepeat:function(n){var t=this;this.checkRepeatLoading=!0;var e=this.entity.consult;this.$request({url:"/consult/checkRepeatConsult",method:"get",params:e}).then(function(n){0===n.data.length?t.$set(t.entity.consult,"cfpd","1"):t.$set(t.entity.consult,"cfpd","0"),t.other.repeatConsults=n.data,t.checkRepeatLoading=!1})},fillConsult:function(n){this.fillEditConsultData(s()({},n)),delete this.entity.consult.id,delete this.entity.consult.entid,this.$set(this.entity.consult,"zxbh",""),n?this.$set(this.entity.consult,"cfpd","0"):this.$set(this.entity.consult,"cfpd","1")},getFileList:function(n){var t=this;n&&this.$request({url:"file/getFileList",params:{groupid:n}}).then(function(n){t.$set(t.file,"list",n.data.map(function(n){return console.log("for=="),{name:n.filename+"【"+n.fileremark+"】",url:n.fileurl}})),t.$nextTick(function(){for(var n=0;n<e.length;n++)e[n].innerHTML.replace('<a class="el-upload-list__item-name">','<a class="el-upload-list__item-name" href="http://www.baidu.com">')});var e=t.$refs.upload.$el.children[2].children;setTimeout(function(){},1)})},xsCheckBoxChange:function(n){n||(this.$set(this.entity.consult,"xsry",""),this.$set(this.entity.consult,"xsrymc",""))},getXsTree:function(){var n=this;this.$request({url:"/consult/getXsTree",method:"get"}).then(function(t){n.tree.xsTree=t.data})},setXsRy:function(){var n=this.$refs.xsTree.getCurrentNode();n.isxs?(this.$set(this.entity.consult,"xsrymc",n.label),this.$set(this.entity.consult,"xsry",n.id),this.window.selectXsWindow=!1):this.$message({type:"error",message:"请选择销售人员"})},selectFile:function(){this.$refs.selectFile.$el.click()},beforeUpload:function(n){console.log(n,"before");var t=!1;return this.$refs.uploadForm.validate(function(n){t=n}),!!t},onSuccess:function(n,t,e){console.log(n,t,e),this.file.groupid=n.data.groupid,this.entity.consult.fj=n.data.groupid}}},i={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("el-dialog",{attrs:{title:"选择销售人员",visible:n.window.selectXsWindow,width:"40%","close-on-click-modal":"","close-on-press-escape":""},on:{"update:visible":function(t){n.$set(n.window,"selectXsWindow",t)}}},[e("el-card",{staticClass:"cardcontainer",staticStyle:{height:"45vh"},attrs:{shadow:"always"}},[e("el-tree",{ref:"xsTree",staticStyle:{"font-size":"14px"},attrs:{data:n.tree.xsTree,"node-key":"id","highlight-current":"","expand-on-click-node":!1,"check-strictly":""}})],1),n._v(" "),e("div",{staticStyle:{"text-align":"right"}},[e("common-button",{on:{click:function(t){n.setXsRy()}}},[n._v("确定")]),n._v(" "),e("common-button",[n._v("取消")])],1)],1),n._v(" "),e("el-card",{directives:[{name:"loading",rawName:"v-loading",value:n.loading.getConsultLoading,expression:"loading.getConsultLoading"}],attrs:{shadow:"always"}},[e("div",{staticClass:"clearfix",staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},["edit"===n.operate?e("common-button",{attrs:{type:"primary",disabled:n.state.commitDone||"edit"!==n.operate},on:{click:function(t){n.saveConsult("save")}}},[e("svg-icon",{attrs:{"icon-class":"save"}}),n._v("  保存")],1):n._e(),n._v(" "),"edit"===n.operate?e("common-button",{attrs:{type:"primary",disabled:n.state.commitDone||"edit"!==n.operate},on:{click:function(t){n.saveConsult("commit")}}},[e("svg-icon",{attrs:{"icon-class":"commit"}}),n._v("  提交")],1):n._e()],1),n._v(" "),e("el-form",{ref:"consult",attrs:{model:n.entity.consult,rules:n.rules,"label-width":"90px",disabled:n.disabledForm}},[e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"咨询来源",prop:"zxly",required:""}},[e("common-select",{ref:"zxlyname",attrs:{url:n.select.zxly.url,required:""},on:{change:n.getZxbh},model:{value:n.entity.consult.zxly,callback:function(t){n.$set(n.entity.consult,"zxly",t)},expression:"entity.consult.zxly"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"咨询类型",prop:"zxlylx",required:""}},[e("common-select",{ref:"zxlylxname",attrs:{url:n.select.zxlylx.url,required:""},model:{value:n.entity.consult.zxlylx,callback:function(t){n.$set(n.entity.consult,"zxlylx",t)},expression:"entity.consult.zxlylx"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"咨询编号"}},[e("el-input",{attrs:{disabled:""},model:{value:n.entity.consult.zxbh,callback:function(t){n.$set(n.entity.consult,"zxbh",t)},expression:"entity.consult.zxbh"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"客户类型",prop:"khlx",required:""}},[e("common-select",{attrs:{url:n.select.khlx.url,required:""},model:{value:n.entity.consult.khlx,callback:function(t){n.$set(n.entity.consult,"khlx",t)},expression:"entity.consult.khlx"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"企业名称",required:""}},[e("el-row",[e("el-col",{attrs:{span:7}},[e("el-form-item",{attrs:{prop:"qymcxl"}},[e("common-select",{attrs:{url:n.select.qymcxl.url,required:""},model:{value:n.entity.consult.qymcxl,callback:function(t){n.$set(n.entity.consult,"qymcxl",t)},expression:"entity.consult.qymcxl"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:17}},[e("el-form-item",{attrs:{prop:"qymc"}},[e("el-input",{model:{value:n.entity.consult.qymc,callback:function(t){n.$set(n.entity.consult,"qymc",t)},expression:"entity.consult.qymc"}})],1)],1)],1)],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"客户名称"}},[e("el-input",{model:{value:n.entity.consult.khxm,callback:function(t){n.$set(n.entity.consult,"khxm",t)},expression:"entity.consult.khxm"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"手机",prop:"sj",required:""}},[e("el-input",{on:{blur:function(t){n.checkRepeat()}},model:{value:n.entity.consult.sj,callback:function(t){n.$set(n.entity.consult,"sj",t)},expression:"entity.consult.sj"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"座机",prop:"zj",required:""}},[e("el-input",{on:{blur:function(t){n.checkRepeat()}},model:{value:n.entity.consult.zj,callback:function(t){n.$set(n.entity.consult,"zj",t)},expression:"entity.consult.zj"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"邮箱"}},[e("el-input",{on:{blur:function(t){n.checkRepeat()}},model:{value:n.entity.consult.email,callback:function(t){n.$set(n.entity.consult,"email",t)},expression:"entity.consult.email"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"微信"}},[e("el-input",{on:{blur:function(t){n.checkRepeat()}},model:{value:n.entity.consult.wechat,callback:function(t){n.$set(n.entity.consult,"wechat",t)},expression:"entity.consult.wechat"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"QQ"}},[e("el-input",{on:{blur:function(t){n.checkRepeat()}},model:{value:n.entity.consult.qq,callback:function(t){n.$set(n.entity.consult,"qq",t)},expression:"entity.consult.qq"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"客服人员"}},[e("el-input",{attrs:{disabled:""},model:{value:n.entity.consult.kfrymc,callback:function(t){n.$set(n.entity.consult,"kfrymc",t)},expression:"entity.consult.kfrymc"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"所在省份",prop:"sf",required:""}},[e("common-select",{attrs:{url:n.select.sf.url,required:""},on:{change:n.getCs},model:{value:n.entity.consult.sf,callback:function(t){n.$set(n.entity.consult,"sf",t)},expression:"entity.consult.sf"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"城市"}},[e("common-select",{ref:"cs",attrs:{cascadingValue:n.entity.consult.sf,cascadingKey:"pid",url:n.select.cs.url,required:""},on:{change:n.checkCs},model:{value:n.entity.consult.cs,callback:function(t){n.$set(n.entity.consult,"cs",t)},expression:"entity.consult.cs"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"重复判定",prop:"cfpd",required:""}},[e("common-select",{attrs:{url:n.select.cfpd.url,required:""},model:{value:n.entity.consult.cfpd,callback:function(t){n.$set(n.entity.consult,"cfpd",t)},expression:"entity.consult.cfpd"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"咨询内容",prop:"jcxm",required:""}},[e("el-input",{attrs:{type:"textarea",placeholder:""},model:{value:n.entity.consult.jcxm,callback:function(t){n.$set(n.entity.consult,"jcxm",t)},expression:"entity.consult.jcxm"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"备注"}},[e("el-input",{attrs:{type:"textarea",placeholder:""},model:{value:n.entity.consult.remarks,callback:function(t){n.$set(n.entity.consult,"remarks",t)},expression:"entity.consult.remarks"}})],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"分配科室",prop:"fpks",required:""}},[e("common-select",{ref:"fpks",attrs:{url:n.select.fpks.url,required:""},model:{value:n.entity.consult.fpks,callback:function(t){n.$set(n.entity.consult,"fpks",t)},expression:"entity.consult.fpks"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item")],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{label:"分配销售"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:3}},[e("el-checkbox",{on:{change:n.xsCheckBoxChange},model:{value:n.entity.consult.assigntype,callback:function(t){n.$set(n.entity.consult,"assigntype",t)},expression:"entity.consult.assigntype"}})],1),n._v(" "),e("el-col",{attrs:{span:14}},[e("el-input",{attrs:{disabled:!n.entity.consult.assigntype,placeholder:""},model:{value:n.entity.consult.xsrymc,callback:function(t){n.$set(n.entity.consult,"xsrymc",t)},expression:"entity.consult.xsrymc"}})],1),n._v(" "),e("el-col",{attrs:{span:5}},[e("common-button",{attrs:{disabled:!n.entity.consult.assigntype},on:{click:function(t){n.window.selectXsWindow=!0}}},[n._v("选择销售人员")])],1)],1)],1)],1)],1),n._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"上传附件"}},[e("el-dialog",{attrs:{title:"上传附件",visible:n.window.uploadWindow,width:"40%","close-on-click-modal":"","close-on-press-escape":""},on:{"update:visible":function(t){n.$set(n.window,"uploadWindow",t)}}},[e("el-form",{ref:"uploadForm",attrs:{model:n.file}},[e("el-form-item",{attrs:{prop:"fileremark",label:"文件描述",required:""}},[e("el-input",{attrs:{placeholder:"请输入文件描述"},model:{value:n.file.fileremark,callback:function(t){n.$set(n.file,"fileremark",t)},expression:"file.fileremark"}})],1),n._v(" "),e("common-button",{on:{click:function(t){n.selectFile()}}},[e("svg-icon",{attrs:{"icon-class":"upload"}}),n._v("选择附件")],1),n._v("\n                选择后自动上传\n              ")],1)],1),n._v(" "),e("el-upload",{ref:"upload",attrs:{action:"http://localhost:9999/file/upload",data:n.file,"with-credentials":"","before-upload":n.beforeUpload,"on-success":n.onSuccess,"file-list":n.file.list}},[e("common-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"selectFile"},[e("svg-icon",{attrs:{"icon-class":"upload"}})],1),n._v(" "),e("common-button",{on:{click:[function(n){n.stopPropagation()},function(t){n.window.uploadWindow=!0}]}},[e("svg-icon",{attrs:{"icon-class":"upload"}}),n._v("上传附件")],1),n._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[n._v("文件格式限制")])],1)],1)],1)],1)],1),n._v(" "),"edit"===n.operate?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading.checkRepeatLoading,expression:"loading.checkRepeatLoading"}],attrs:{border:"",data:n.other.repeatConsults,height:"32vh"}},[e("el-table-column",{attrs:{label:"操作"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("common-button",{staticStyle:{color:"blue"},on:{click:function(e){n.fillConsult(t.row)}}},[n._v("回填咨询")])]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"咨询编号",prop:"zxbh",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"咨询时间",prop:"createtime",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"咨询来源",prop:"zxlyname",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"咨询类型",prop:"zxlylxname",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"企业名称",prop:"qymc",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"咨询内容",prop:"jcxm",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"客服人员",prop:"kfrymc",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"分配科室",prop:"fpksmc",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"销售人员",prop:"xsrymc",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{label:"咨询状态",prop:"zxztname",align:"center"}})],1):n._e()],1)],1)},staticRenderFns:[]};var a=e("VU/8")(o,i,!1,function(n){e("PwVi")},"data-v-2ebca8fc",null);t.default=a.exports}});