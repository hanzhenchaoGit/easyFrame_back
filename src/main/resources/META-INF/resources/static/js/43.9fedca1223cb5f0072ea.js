webpackJsonp([43],{k0lc:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("woOf"),n=o.n(s),r={mounted:function(){},data:function(){return{currentRow:[],id:"",wReason:"",formOptions:{formType:"simple",inline:!0,showResetBtn:!0,showSearchBtn:!0,submitBtnText:"查询",resetBtnText:"重置",forms:[{prop:"status",label:"请求类型",itemType:"select",url:"/system/proxyExcute?uuid=d1e2c0c0-d50f-4fc5-85b9-ea903493d4e6"}]},kdForm:{},searchForm:{postperson:"",ksname:"",zxnum:"",status:"",sfolderno:"",starttime:"",endtime:"",postcompname:""},rowID:"",reason:"",starttime:"",endtime:"",postcompname:"",postperson:"",folderno:"",ksname:"",zxnum:"",sfolderno:"",addWindow:!1,searchWindow:!1,showReason:!1,url:"/AdminKDInfo/searchInfo",rules:{reason:[{required:!0,message:"请输入退回原因"},{min:1,max:1e3,message:"长度在 1 到 1000 个字符",trigger:"blur"}]},columns:[{colType:"selection"},{prop:"id",label:"ID"},{prop:"FOLDERNO",label:"委托单号"},{prop:"zxno",label:"咨询/客户单号"},{prop:"POSTDATE",label:"发起时间"},{prop:"POSTCOMPNAME",label:"发起公司"},{prop:"KDDETAIL",label:"快递内容"},{prop:"KSName",label:"科室"},{prop:"postPerson",label:"提交人"},{prop:"reason",slotName:"waitReason",label:"等待原因"},{prop:"DISPSTATUS",label:"订单状态"},{label:"操作",slotName:"edit",width:300}],select:{postcompname:{url:"/system/proxyExcute?uuid=d1e2c0c0-d50f-4fc5-85b9-ea903493d4e6"},receiveprovince:{url:"system/proxyExcute?uuid=1faf1d01-88ed-4e8e-8975-7eaa2c179135&level=1"},receivecity:{url:"system/proxyExcute?uuid=d1e2c0c0-d50f-4fc5-85b9-ea903493d4e6"},postaddress:{url:"system/proxyExcute?uuid=284219ff-ce8f-45c3-81a4-7b8de1a754fa"},kdAdmin:{url:"system/proxyExcute?uuid=1c7cdd05-1ab5-403b-addd-aab8f2456d00"},default:{url:"system/proxyExcute?uuid=1c7cdd05-1ab5-403b-addd-aab8f2456d00"},ksname:{url:"/system/proxyExcute?uuid=faf4b6d2-80fa-446c-a184-eb0f279b51fd"}},entity:{consult:{}}}},methods:{checkAble:function(e,t){if("等待取件"!==e.DISPSTATUS)return!0},searchInfo:function(){console.log(this.searchForm.sfolderno),this.$set(this,"searchWindow",!1),this.$refs.table.fetchHandler({folderno:this.searchForm.sfolderno,zxnum:this.searchForm.zxnum,starttime:this.searchForm.starttime,endtime:this.searchForm.endtime,postcompname:this.searchForm.postcompname,postperson:this.searchForm.postperson,ksname:this.searchForm.ksname})},search:function(){this.$set(this,"searchWindow",!0)},clickTable:function(e,t){console.log(e.DISPSTATUS),"reason"===t.property&&"未处理"===e.DISPSTATUS?this.$set(e,"edit",!0):this.$set(e,"edit",!1)},submit:function(){var e=this;this.$refs.form.validate(function(t){if(console.log(t),t){var o=e.kdForm;e.$set(e,"reason",o),e.$set(e,"addWindow",!1),e.$request({url:"/AdminKDInfo/backKD",method:"post",data:o}).then(function(t){t.data?e.$refs.table.fetchHandler():e.$message({showClose:!0,message:"查看失败",type:"warning"})})}})},syncStatus:function(e,t){var o=this;console.log(t.dispstatus),this.$confirm("确定同步状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$request({url:"/AdminKDInfo/syncStatus",method:"get",params:{ID:t.id,dispstatus:t.dispstatus}}).then(function(e){e.data?o.$refs.table.fetchHandler():o.$message({showClose:!0,message:"同步状态失败",type:"warning"})})}).catch(function(){})},selectRow:function(e,t){this.currentRow=n()([],e),this.currentRow=this.currentRow.map(function(e){return e.id})},batchRegister:function(){var e=this,t=this.currentRow;this.$request({url:"/AdminKDInfo/registerAllKD",method:"post",data:t}).then(function(t){t.data?(console.log(22334),e.$refs.table.fetchHandler()):e.$message({showClose:!0,message:"查看失败",type:"warning"})})},batchSyncStatus:function(){var e=this,t=this.currentRow;this.$request({url:"/AdminKDInfo/batchSyncStatus",method:"post",data:t}).then(function(t){t.data?(console.log(22334),e.$refs.table.fetchHandler()):e.$message({showClose:!0,message:"查看失败",type:"warning"})})},writeReason:function(e,t){var o=this;console.log(t.reason),this.$request({url:"/KDInfo/updateKDInfoById",method:"get",params:{Id:t.id,reason:t.reason}}).then(function(e){e.data?o.$refs.table.fetchHandler():o.$message({showClose:!0,message:"查看失败",type:"warning"})})},save:function(){var e=this;this.$refs.form.validate(function(t){e.addWindow=!1;var o=e.entity.consult;e.$request({url:"/KDInfo/updateKDInfo",method:"post",data:o}).then(function(t){t.data&&e.$refs.table.fetchHandler()})})},recall:function(e,t){var o=this;console.log(t.id),this.$request({url:"/KDInfo/deleteKdInfo",method:"get",params:{ID:t.id}}).then(function(e){e.data?o.$refs.table.fetchHandler():o.$message({showClose:!0,message:"查看失败",type:"warning"})})},register:function(e,t){var o=this;console.log(t.id),this.$request({url:"/AdminKDInfo/registerKD",method:"get",params:{ID:t.id,STEP:"waitTake"}}).then(function(e){e.data?o.$refs.table.fetchHandler():o.$message({showClose:!0,message:"查看失败",type:"warning"})})},back:function(e,t){console.log(t.id),this.$set(this,"addWindow",!0),this.$set(this,"rowID",t.id),this.$set(this.kdForm,"id",t.id)},canel:function(e,t){var o=this;this.$confirm("确定取消取件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$request({url:"/AdminKDInfo/registerKD",method:"get",params:{ID:t.id,STEP:"canel"}}).then(function(e){e.data?(console.log(22334),o.$refs.table.fetchHandler()):o.$message({showClose:!0,message:"查看失败",type:"warning"})})}).catch(function(){})}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",[o("el-dialog",{attrs:{visible:e.searchWindow,width:"40%","close-on-click-modal":"","close-on-press-escape":""},on:{"update:visible":function(t){e.searchWindow=t}}},[o("el-form",{ref:"searchForm",attrs:{model:e.searchForm}},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"咨询编号"}},[o("el-input",{model:{value:e.searchForm.zxnum,callback:function(t){e.$set(e.searchForm,"zxnum",t)},expression:"searchForm.zxnum"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"请求类型"}},[o("common-select",{attrs:{url:e.select.postcompname.url},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"开始时间"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.searchForm.starttime,callback:function(t){e.$set(e.searchForm,"starttime",t)},expression:"searchForm.starttime"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"结束时间"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.searchForm.endtime,callback:function(t){e.$set(e.searchForm,"endtime",t)},expression:"searchForm.endtime"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"委托单号"}},[o("el-input",{model:{value:e.searchForm.sfolderno,callback:function(t){e.$set(e.searchForm,"sfolderno",t)},expression:"searchForm.sfolderno"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"发起公司"}},[o("el-input",{model:{value:e.searchForm.postcompname,callback:function(t){e.$set(e.searchForm,"postcompname",t)},expression:"searchForm.postcompname"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"提交人"}},[o("el-input",{model:{value:e.searchForm.postperson,callback:function(t){e.$set(e.searchForm,"postperson",t)},expression:"searchForm.postperson"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"科室"}},[o("common-select",{attrs:{url:e.select.ksname.url},model:{value:e.searchForm.ksname,callback:function(t){e.$set(e.searchForm,"ksname",t)},expression:"searchForm.ksname"}})],1)],1)],1),e._v(" "),o("common-button",{attrs:{type:"primary"},on:{click:function(t){e.searchInfo()}}},[e._v("查询")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:e.addWindow,width:"20%","close-on-click-modal":"","close-on-press-escape":""},on:{"update:visible":function(t){e.addWindow=t}}},[o("el-form",{ref:"form",attrs:{model:e.kdForm,rules:e.rules}},[o("el-row",[o("el-col",[o("el-form-item",{attrs:{prop:"reason",label:"退回原因"}},[o("el-input",{staticStyle:{width:"330px"},attrs:{type:"textarea",autosize:"",required:""},model:{value:e.kdForm.reason,callback:function(t){e.$set(e.kdForm,"reason",t)},expression:"kdForm.reason"}})],1),e._v(" "),o("el-input",{attrs:{type:"hidden",value:""},model:{value:e.kdForm.id,callback:function(t){e.$set(e.kdForm,"id",t)},expression:"kdForm.id"}})],1)],1),e._v(" "),o("common-button",{attrs:{type:"primary"},on:{click:function(t){e.submit()}}},[e._v("保存")])],1)],1),e._v(" "),o("common-table",{ref:"table",attrs:{url:e.url,"highlight-current-row":"",formOptions:e.formOptions,checkboxFun:e.checkAble,columns:e.columns,fit:"",autoLoad:""},on:{select:e.selectRow,"cell-click":e.clickTable},scopedSlots:e._u([{key:"buttons",fn:function(t){return[o("common-button",{on:{click:function(t){e.batchRegister()}}},[e._v("批量登记取件")]),e._v(" "),o("common-button",{on:{click:function(t){e.batchSyncStatus()}}},[e._v("批量同步状态")]),e._v(" "),o("common-button",{on:{click:function(t){e.search()}}},[e._v("高级查询")])]}},{key:"waitReason",fn:function(t){return[t.row.edit?o("el-input",{attrs:{type:"text",autosize:""},on:{blur:function(o){e.writeReason(t.$index,t.row)}},model:{value:t.row.reason,callback:function(o){e.$set(t.row,"reason",o)},expression:"scope.row.reason"}}):o("span",[e._v(e._s(t.row.reason))])]}},{key:"edit",fn:function(t){return["未处理"===t.row.DISPSTATUS||"等待寄送"===t.row.DISPSTATUS?o("common-button",{on:{click:function(o){e.syncStatus(t.$index,t.row)}}},[e._v("同步状态")]):e._e(),e._v(" "),"未处理"===t.row.DISPSTATUS||"等待寄送"===t.row.DISPSTATUS?o("common-button",{on:{click:function(o){e.register(t.$index,t.row)}}},[e._v("登记取件")]):e._e(),e._v(" "),"未处理"===t.row.DISPSTATUS||"等待寄送"===t.row.DISPSTATUS?o("common-button",{on:{click:function(o){e.back(t.$index,t.row)}}},[e._v("退回")]):e._e(),e._v(" "),"等待取件"===t.row.DISPSTATUS?o("common-button",{on:{click:function(o){e.canel(t.$index,t.row)}}},[e._v("取消取件")]):e._e()]}}])})],1)],1)},staticRenderFns:[]},c=o("VU/8")(r,a,!1,null,null,null);t.default=c.exports}});