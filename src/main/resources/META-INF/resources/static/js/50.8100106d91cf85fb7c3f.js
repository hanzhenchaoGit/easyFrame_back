webpackJsonp([50],{qGOm:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("woOf"),s=o.n(n),r={data:function(){return{addWindow:!1,foodsForm:{},taskList:[],currentRow:[],inputwidth:"120",url:"/foods/getFoodsOrderByPager",formOptions:{inline:!0,showResetBtn:!0,showSearchBtn:!0,submitBtnText:"查询",resetBtnText:"重置",forms:[{prop:"cusname",label:"员工名称"}],formType:"simple"},rules:{cusname:[{required:!0,message:"请输入部门名称"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],orgname:[{required:!0,message:"请输入员工名称"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],ordnum:[{required:!0,message:"请输入订餐数量"}]},columns:[{colType:"selection"},{prop:"id",label:"",width:50},{slotName:"watch",label:"操作"},{prop:"cusname",label:"部门名称"},{prop:"orgname",label:"员工名称"},{prop:"ordnum",label:"数量"},{prop:"createtime",label:"下单时间"},{slotName:"status",label:"订单状态"}]}},mounted:function(){},methods:{checkAble:function(e,t){var o=new Date,n=o.getDate(),s=o.getMonth()+1,r=o.getFullYear(),a=e.createtime,i=a.substring(8,10),l=parseInt(i),u=a.substring(5,7),c=parseInt(u),m=a.substring(0,4),d=parseInt(m);return n===l&&s===c&&r===d},selectRow:function(e,t){this.currentRow=s()([],e),this.currentRow=this.currentRow.map(function(e){return e.id}),console.log(this.currentRow,t,"---")},handleAdd:function(e,t){var o=this;(new Date).getHours()>=11?this.$message({showClose:!0,message:"每天的11点之后不能添加订单",type:"warning"}):(this[t]=!0,setTimeout(function(){o.$refs[e].resetFields(),o.foodsForm={}},1))},save:function(){var e=this,t=new Date;this.$refs.form.validate(function(o){e.addWindow=!1;var n=e.foodsForm;o&&t.getHours()<11?e.$request({url:"/foods/addFoodsOrder",method:"post",data:n}).then(function(t){e.returnMsg(e,t),e.$refs.table.fetchHandler()}):e.$message({showClose:!0,message:"每天的11点之后不能添加订单",type:"warning"})})},watch:function(e,t){this.addWindow=!0,this.foodsForm=s()({},t)},changeOrderStatus:function(e){var t=this,o={orderIds:this.currentRow,status:"1"},n=new Date;n.getHours()<11&&(o.status="commit"===e?"2":"0"),n.getHours()>=11&&("commit"===e?this.$message({showClose:!0,message:"每天的11点之后不能提交订单",type:"warning"}):this.$message({showClose:!0,message:"每天的11点之后不能取消订单",type:"warning"})),this.$request({url:"/foods/changeFoodsOrderStatus",method:"post",data:o}).then(function(e){t.returnMsg(t,e),t.$refs.table.fetchHandler()})},Delete:function(e){var t=this;this.$request({url:"/foods/delFoodsOrder",params:{id:e.id}}).then(function(e){t.$message({message:"订单取消",type:"info",duration:5e3}),t.$refs.table.fetchHandler()})}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",[o("el-dialog",{attrs:{visible:e.addWindow,width:"40%","close-on-click-modal":"","close-on-press-escape":""},on:{"update:visible":function(t){e.addWindow=t}}},[o("el-form",{ref:"form",attrs:{inline:"",model:e.foodsForm,"label-width":"120px","label-position":"left",rules:e.rules}},[o("el-form-item",{style:{width:e.inputwidth},attrs:{prop:"cusname",label:"部门名称",required:""}},[o("el-input",{model:{value:e.foodsForm.cusname,callback:function(t){e.$set(e.foodsForm,"cusname",t)},expression:"foodsForm.cusname"}})],1),e._v(" "),o("el-form-item",{style:{width:e.inputwidth},attrs:{prop:"orgname",label:"员工名称",required:""}},[o("el-input",{model:{value:e.foodsForm.orgname,callback:function(t){e.$set(e.foodsForm,"orgname",t)},expression:"foodsForm.orgname"}})],1),e._v(" "),o("el-form-item",{style:{width:e.inputwidth},attrs:{prop:"ordnum",label:"数量",min:"1",required:""}},[o("el-input-number",{attrs:{min:0},model:{value:e.foodsForm.ordnum,callback:function(t){e.$set(e.foodsForm,"ordnum",t)},expression:"foodsForm.ordnum"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"note",label:"备注"}},[o("el-input",{staticStyle:{width:"330px"},attrs:{type:"textarea",autosize:""},model:{value:e.foodsForm.note,callback:function(t){e.$set(e.foodsForm,"note",t)},expression:"foodsForm.note"}})],1),e._v(" "),o("el-form-item",[o("common-button",{attrs:{type:"primary"},on:{click:function(t){e.save()}}},[e._v("保存")]),e._v(" "),o("common-button",{attrs:{type:"primary"},on:{click:function(t){e.addWindow=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),o("common-table",{ref:"table",attrs:{url:e.url,"highlight-current-row":"",checkboxFun:e.checkAble,columns:e.columns,fit:"",autoLoad:"",formOptions:e.formOptions},on:{select:e.selectRow},scopedSlots:e._u([{key:"topbutton",fn:function(t){return[o("common-button",{attrs:{type:"primary"},on:{click:[function(e){e.stopPropagation()},function(t){e.handleAdd("form","addWindow")}]}},[e._v("添加")])]}},{key:"watch",fn:function(t){return[o("common-button",{attrs:{type:"primary"},on:{click:function(o){e.watch(t.$index,t.row)}}},[e._v("查看")])]}},{key:"buttons",fn:function(t){return[o("common-button",{attrs:{type:"success"},on:{click:function(t){e.changeOrderStatus("commit")}}},[e._v("提交订单")]),e._v(" "),o("common-button",{attrs:{type:"danger"},on:{click:function(t){e.changeOrderStatus("cancel")}}},[e._v("取消订单")])]}},{key:"status",fn:function(t){return["0"==t.row.status?o("span",{staticStyle:{color:"red"}},[e._v("已取消")]):e._e(),e._v(" "),"1"==t.row.status?o("span",{staticStyle:{color:"blue"}},[e._v("未提交")]):e._e(),e._v(" "),"2"==t.row.status?o("span",{staticStyle:{color:"green"}},[e._v("已提交")]):e._e()]}}])})],1)],1)},staticRenderFns:[]},i=o("VU/8")(r,a,!1,null,null,null);t.default=i.exports}});